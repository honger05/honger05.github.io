!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){function r(e,t){t&&(e+=1462);var n=Date.parse(e);return(n-new Date(Date.UTC(1899,11,30)))/864e5}function o(e,t){for(var n={},o={s:{c:1e7,r:1e7},e:{c:0,r:0}},i=0;i!=e.length;++i)for(var a=0;a!=e[i].length;++a){o.s.r>i&&(o.s.r=i),o.s.c>a&&(o.s.c=a),o.e.r<i&&(o.e.r=i),o.e.c<a&&(o.e.c=a);var c={v:e[i][a]};if(null!=c.v){var s=XLSX.utils.encode_cell({c:a,r:i});"number"==typeof c.v?c.t="n":"boolean"==typeof c.v?c.t="b":c.v instanceof Date?(c.t="n",c.z=XLSX.SSF._table[14],c.v=r(c.v)):c.t="s",n[s]=c}}return o.s.c<1e7&&(n["!ref"]=XLSX.utils.encode_range(o)),n}function i(){return this instanceof i?(this.SheetNames=[],void(this.Sheets={})):new i}function a(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function c(e){var t=document.getElementById(e),n=s(t),r=n[1],c=n[0],u="SheetJS";console.log(c);var l=new i,f=o(c);f["!merges"]=r,l.SheetNames.push(u),l.Sheets[u]=f;var h=XLSX.write(l,{bookType:"xlsx",bookSST:!1,type:"binary"});m.saveAs(new Blob([a(h)],{type:"application/octet-stream"}),"test.xlsx")}function s(e){for(var t=[],n=e.querySelectorAll("tr"),r=[],o=0;o<n.length;++o){for(var i=[],a=n[o],c=a.querySelectorAll("td"),s=0;s<c.length;++s){var u=c[s],l=u.getAttribute("colspan"),f=u.getAttribute("rowspan"),h=u.innerText;if(""!==h&&h==+h&&(h=+h),r.forEach(function(e){if(o>=e.s.r&&o<=e.e.r&&i.length>=e.s.c&&i.length<=e.e.c)for(var t=0;t<=e.e.c-e.s.c;++t)i.push(null)}),(f||l)&&(f=f||1,l=l||1,r.push({s:{r:o,c:i.length},e:{r:o+f-1,c:i.length+l-1}})),i.push(""!==h?h:null),l)for(var d=0;l-1>d;++d)i.push(null)}t.push(i)}return[t,r]}function u(e){var t=e.target.files;f(t)}function l(e){e.preventDefault(),e.stopPropagation();var t=e.dataTransfer.files;f(t)}function f(e){var t,n,r;for(t=0,r=e.length;r>t;++t){n=e[t];var o=new FileReader;n.name;o.onload=function(e){var t=e.target.result,n=XLSX.read(t,{type:"binary"});h(n)},o.readAsBinaryString(n)}}function h(e){var t="";switch(p("format")){case"json":t=JSON.stringify(v(e),2,2);break;case"form":t=y(e);break;default:t=g(e)}R.innerText=t}function d(e){console.log("yes, you can drop"),e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}function p(e){for(var t=document.getElementsByName(e),n=0,r=t.length;r>n;n++)if(t[n].checked||1===r)return t[n].value}function v(e){var t={};return e.SheetNames.forEach(function(n){var r=XLSX.utils.sheet_to_row_object_array(e.Sheets[n]);r.length>0&&(t[n]=r)}),t}function g(e){var t=[];return e.SheetNames.forEach(function(n){var r=XLSX.utils.sheet_to_csv(e.Sheets[n]);r.length>0&&(t.push("SHEET: "+n),t.push(""),t.push(r))}),t.join("\n")}function y(e){var t=[];return e.SheetNames.forEach(function(n){var r=XLSX.utils.get_formulae(e.Sheets[n]);r.length>0&&(t.push("SHEET: "+n),t.push(""),t.push(r.join("\n")))}),t.join("\n")}var m=n(3),S=n(2),w="	1850,20,0,1,1017281\r\n	1850,20,0,2,1003841\r\n	1850,20,0,3,1003243",b=new S(w).parse(),w=[[1,2,3],[!0,!1,null,"sheetjs"],["foo","bar",new Date("2014-02-19T14:30Z"),"0.3"],["baz",null,"qux"]],E="SheetJS",D=([["001",211,300],[!0,!1,null,"sheetjs"],["foo","bar",new Date("2014-02-19T14:30Z"),"0.3"],["baz",null,"qux"]],"OtherJS"),A=new i,N=o(w);A.SheetNames.push(E),A.Sheets[E]=N;var x=o(b);A.SheetNames.push(D),A.Sheets[D]=x;var L=XLSX.write(A,{bookType:"xlsx",bookSST:!0,type:"binary"});document.getElementById("download").addEventListener("click",function(){m.saveAs(new Blob([a(L)],{type:"application/octet-stream"}),"test.xlsx")});var O=document.getElementById("table2excel");O.addEventListener("click",c.bind(this,"table"));var T=document.getElementById("selectFiles"),j=document.getElementById("drop"),R=document.getElementById("out");T.addEventListener("change",u,!1),j.addEventListener("dragover",d,!1),j.addEventListener("drop",l,!1)},function(e,t,n){var r,o,i;!function(n,a){o=[],r=a,i="function"==typeof r?r.apply(t,o):r,!(void 0!==i&&(e.exports=i))}(this,function(){"use strict";function e(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function t(e){return"string"==typeof e}function n(e){return!isNaN(Number(e))}function r(e){return 0==e||1==e}function o(e){return null==e}function i(e){return null!=e}function a(e,t){return i(e)?e:t}function c(e,t){for(var n=0,r=e.length;r>n&&t(e[n],n)!==!1;n+=1);}function s(e){return e.replace(/"/g,'\\"')}function u(e){return"attrs["+e+"]"}function l(e,t){return n(e)?"Number("+u(t)+")":r(e)?"Boolean("+u(t)+" == true)":"String("+u(t)+")"}function f(e,n,r,o){var i=[];return 3==arguments.length?(n?g(n)?c(r,function(r,o){t(n[o])?n[o]=n[o].toLowerCase():e[n[o]]=n[o],i.push("deserialize[cast["+o+"]]("+u(o)+")")}):c(r,function(e,t){i.push(l(e,t))}):c(r,function(e,t){i.push(u(t))}),i="return ["+i.join(",")+"]"):(n?g(n)?c(r,function(r,a){t(n[a])?n[a]=n[a].toLowerCase():e[n[a]]=n[a],i.push('"'+s(o[a])+'": deserialize[cast['+a+"]]("+u(a)+")")}):c(r,function(e,t){i.push('"'+s(o[t])+'": '+l(e,t))}):c(r,function(e,t){i.push('"'+s(o[t])+'": '+u(t))}),i="return {"+i.join(",")+"}"),new Function("attrs","deserialize","cast",i)}function h(e,t){var n,r=0;return c(t,function(t){var o,i=t;-1!=d.indexOf(t)&&(i="\\"+i),o=e.match(new RegExp(i,"g")),o&&o.length>r&&(r=o.length,n=t)}),n||t[0]}var d=["|","^"],p=[",",";","	","|","^"],v=["\r\n","\r","\n"],g=Array.isArray||function(e){return"[object Array]"===toString.call(e)},y=function(){function n(e,n){if(n||(n={}),g(e))this.mode="encode";else{if(!t(e))throw new Error("Incompatible format!");this.mode="parse"}this.data=e,this.options={header:a(n.header,!1),cast:a(n.cast,!0)};var r=n.lineDelimiter||n.line,o=n.cellDelimiter||n.delimiter;this.isParser()?(this.options.lineDelimiter=r||h(this.data,v),this.options.cellDelimiter=o||h(this.data,p),this.data=i(this.data,this.options.lineDelimiter)):this.isEncoder()&&(this.options.lineDelimiter=r||"\r\n",this.options.cellDelimiter=o||",")}function r(e,t,n,r,o){e(new t(n,r,o))}function i(e,t){return e.slice(-t.length)!=t&&(e+=t),e}function s(n){return g(n)?"array":e(n)?"object":t(n)?"string":o(n)?"null":"primitive"}return n.prototype.set=function(e,t){return this.options[e]=t},n.prototype.isParser=function(){return"parse"==this.mode},n.prototype.isEncoder=function(){return"encode"==this.mode},n.prototype.parse=function(e){function t(){s={escaped:!1,quote:!1,cell:!0}}function n(){v.cell=""}function o(){v.line=[]}function i(e){v.line.push(s.escaped?e.slice(1,-1).replace(/""/g,'"'):e),n(),t()}function a(e){i(e.slice(0,1-d.lineDelimiter.length))}function c(){p?g(p)?(u=f(y,d.cast,v.line,p),(c=function(){r(e,u,v.line,y,d.cast)})()):p=v.line:(u||(u=f(y,d.cast,v.line)),(c=function(){r(e,u,v.line,y,d.cast)})())}if("parse"==this.mode){if(0===this.data.trim().length)return[];var s,u,l,h=this.data,d=this.options,p=d.header,v={cell:"",line:[]},y=this.deserialize;e||(l=[],e=function(e){l.push(e)}),1==d.lineDelimiter.length&&(a=i);var m,S,w,b=h.length,E=d.cellDelimiter.charCodeAt(0),D=d.lineDelimiter.charCodeAt(d.lineDelimiter.length-1);for(t(),m=0,S=0;b>m;m++)w=h.charCodeAt(m),s.cell&&(s.cell=!1,34==w)?s.escaped=!0:s.escaped&&34==w?s.quote=!s.quote:(s.escaped&&s.quote||!s.escaped)&&(w==E?(i(v.cell+h.slice(S,m)),S=m+1):w==D&&(a(v.cell+h.slice(S,m)),S=m+1,c(),o()));return l?l:this}},n.prototype.deserialize={string:function(e){return String(e)},number:function(e){return Number(e)},"boolean":function(e){return Boolean(e)}},n.prototype.serialize={object:function(e){var t=this,n=Object.keys(e),r=Array(n.length);return c(n,function(n,o){r[o]=t[s(e[n])](e[n])}),r},array:function(e){var t=this,n=Array(e.length);return c(e,function(e,r){n[r]=t[s(e)](e)}),n},string:function(e){return'"'+String(e).replace(/"/g,'""')+'"'},"null":function(e){return""},primitive:function(e){return e}},n.prototype.encode=function(e){function n(e){return e.join(a.cellDelimiter)}if("encode"==this.mode){if(0==this.data.length)return"";var r,o,i=this.data,a=this.options,u=a.header,l=i[0],f=this.serialize,h=0;e||(o=Array(i.length),e=function(e,t){o[t+h]=e}),u&&(g(u)||(r=Object.keys(l),u=r),e(n(f.array(u)),0),h=1);var d,p=s(l);return"array"==p?(g(a.cast)?(d=Array(a.cast.length),c(a.cast,function(e,n){t(e)?d[n]=e.toLowerCase():(d[n]=e,f[e]=e)})):(d=Array(l.length),c(l,function(e,t){d[t]=s(e)})),c(i,function(t,r){var o=Array(d.length);c(t,function(e,t){o[t]=f[d[t]](e)}),e(n(o),r)})):"object"==p&&(r=Object.keys(l),g(a.cast)?(d=Array(a.cast.length),c(a.cast,function(e,n){t(e)?d[n]=e.toLowerCase():(d[n]=e,f[e]=e)})):(d=Array(r.length),c(r,function(e,t){d[t]=s(l[e])})),c(i,function(t,o){var i=Array(r.length);c(r,function(e,n){i[n]=f[d[n]](t[e])}),e(n(i),o)})),o?o.join(a.lineDelimiter):this}},n.prototype.forEach=function(e){return this[this.mode](e)},n}();return y.parse=function(e,t){return new y(e,t).parse()},y.encode=function(e,t){return new y(e,t).encode()},y.forEach=function(e,t,n){return 2==arguments.length&&(n=t),new y(e,t).forEach(n)},y})},function(e,t){var n=n||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in r,i=function(e){var t=new MouseEvent("click");e.dispatchEvent(t)},a=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),c=e.webkitRequestFileSystem,s=e.requestFileSystem||c||e.mozRequestFileSystem,u=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},l="application/octet-stream",f=0,h=500,d=function(t){var r=function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()};e.chrome?r():setTimeout(r,h)},p=function(e,t,n){t=[].concat(t);for(var r=t.length;r--;){var o=e["on"+t[r]];if("function"==typeof o)try{o.call(e,n||e)}catch(i){u(i)}}},v=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e},g=function(t,u,h){h||(t=v(t));var g,y,m,S=this,w=t.type,b=!1,E=function(){p(S,"writestart progress write writeend".split(" "))},D=function(){if(y&&a&&"undefined"!=typeof FileReader){var r=new FileReader;return r.onloadend=function(){var e=r.result;y.location.href="data:attachment/file"+e.slice(e.search(/[,;]/)),S.readyState=S.DONE,E()},r.readAsDataURL(t),void(S.readyState=S.INIT)}if((b||!g)&&(g=n().createObjectURL(t)),y)y.location.href=g;else{var o=e.open(g,"_blank");void 0==o&&a&&(e.location.href=g)}S.readyState=S.DONE,E(),d(g)},A=function(e){return function(){return S.readyState!==S.DONE?e.apply(this,arguments):void 0}},N={create:!0,exclusive:!1};return S.readyState=S.INIT,u||(u="download"),o?(g=n().createObjectURL(t),r.href=g,r.download=u,void setTimeout(function(){i(r),E(),d(g),S.readyState=S.DONE})):(e.chrome&&w&&w!==l&&(m=t.slice||t.webkitSlice,t=m.call(t,0,t.size,l),b=!0),c&&"download"!==u&&(u+=".download"),(w===l||c)&&(y=e),s?(f+=t.size,void s(e.TEMPORARY,f,A(function(e){e.root.getDirectory("saved",N,A(function(e){var n=function(){e.getFile(u,N,A(function(e){e.createWriter(A(function(n){n.onwriteend=function(t){y.location.href=e.toURL(),S.readyState=S.DONE,p(S,"writeend",t),d(e)},n.onerror=function(){var e=n.error;e.code!==e.ABORT_ERR&&D()},"writestart progress write abort".split(" ").forEach(function(e){n["on"+e]=S["on"+e]}),n.write(t),S.abort=function(){n.abort(),S.readyState=S.DONE},S.readyState=S.WRITING}),D)}),D)};e.getFile(u,{create:!1},A(function(e){e.remove(),n()}),A(function(e){e.code===e.NOT_FOUND_ERR?n():D()}))}),D)}),D)):void D())},y=g.prototype,m=function(e,t,n){return new g(e,t,n)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return n||(e=v(e)),navigator.msSaveOrOpenBlob(e,t||"download")}:(y.abort=function(){var e=this;e.readyState=e.DONE,p(e,"abort")},y.readyState=y.INIT=0,y.WRITING=1,y.DONE=2,y.error=y.onwritestart=y.onprogress=y.onwrite=y.onabort=y.onerror=y.onwriteend=null,m)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);e.exports.saveAs=n}]);